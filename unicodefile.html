<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no"><title  id="page-title">STaTbS21D - Spell Coding</title><meta name="description" content="Synoptic Edition of Book of the Dead Spell Sources from the 21st Dynasty (STaTbS21D) is a Digital Humanities project on Egyptology, provides edited and digitalized Book of the Dead spell sources from the end of the New Kingdom and the beginning of the Third Intermediate Period (particularly the 21st Dynasty) for the Egyptological community and the general public."><link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,400i,700,700i,600,600i&amp;display=swap"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.4.1/css/simple-line-icons.min.css">
<link href="https://db.onlinewebfonts.com/c/0c5e6f133b0b25edfed47aca4ab57676?family=Segoe+UI+Historic" rel="stylesheet"> 
<!--link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Egyptian+Hieroglyphs&display=swap" rel="stylesheet"-->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/baguettebox.js/1.11.1/baguetteBox.min.css">
<link  id="page-css" rel="stylesheet" href="assets/css/styles.min.css">
<script src="assets/js/jquery-3.6.3.js?h=84e399b8f2181ccd73394fdeddff1638"></script>
<script src="assets/js/crypto-js.min.js"></script>
</head>

<body>

<nav id="nav-bar" class="navbar navbar-light navbar-expand-lg sticky-top bg-white clean-navbar" style="position: relative;overflow: visible;display: inline;"></nav>

<main class="page faq-page">

<section class="clean-block clean-faq dark">

<div id="markdownContent" class="container">

		<div id="loader" align="center"><br><br><div class="block-content"><img src="assets/img/loading.gif" /></div></div>

</div>

</section>

</main>

<script>
       $(document).ready(function () {
		
			const urlParams = new URLSearchParams(window.location.search);
			const TM = 'TM ' + urlParams.get("id");  // TM '135240'
			const Spell = 'Spell ' + urlParams.get("spell");  // Spell '194'
			var githubURL = 'https://raw.githubusercontent.com/STaTbS21D/Book_of_the_Dead_Sources/main/' + Spell + '/Unicode/';
			
			
			var owner = 'STaTBS21D';
            var repo = 'Book_of_the_Dead_Sources';
            var token = 'U2FsdGVkX1/o/4PlzavsXrZ3oQmKr/WA8zHuMWQwZfxTPcwWjWOrWLSxxFQ9REd10KY3i3R8T0rvI8NY1oMIbBvTmnngNWxH8hrHYlEe4VLQgssCbY5Af+DxFkwB7MkIXswSZItuoayQeKIvcKATGg=='; 
			var password = 'senerpaitui';
			var decryptedBytes = CryptoJS.AES.decrypt(token, password);
			token = decryptedBytes.toString(CryptoJS.enc.Utf8);
			
			var unicodefile = '';
			
			function getUnicodeFile() {
			
                var url = 'https://api.github.com/repos/' + owner + '/' + repo + '/git/trees/main?recursive=1';

                var headers = {
                    'Authorization': 'Bearer ' + token,
					 'X-GitHub-Api-Version': '2022-11-28'
                };

                $.ajax({
                    url: url,
                    headers: headers,
                    success: function(response) {
                        var folderList = {};
						
			// Loop through the repository contents
                        $.each(response.tree, function(index, item) {
                            if (item.type === 'blob') {
                                var path = item.path;
								
                                if (path.includes('Unicode/')) {
                                    var rootFolder = Spell; 

                                    if (rootFolder) {
                                        if (!folderList[rootFolder]) {
                                            folderList[rootFolder] = [];
                                        }

                                        folderList[rootFolder].push(path);
                                    }
                                }
                            }
                        });
						
						var fileName = '';
						
						$.each(folderList, function(folder, files) {
						
							$.each(files, function(index, file) {
							
							var segments = file.split('/');
							var ind = segments.indexOf(Spell);
							var unicodef = '';

							if (ind !== -1 && segments.length > ind + 1) {
								unicodef = segments[ind + 2];
							
								if(unicodef.startsWith(TM))
								{
									unicodefile = unicodef;
									
									return false;									
								}
							}				
							$('#markdownContent').html('<div align="center">Spell ' + Spell + ' is not available for the given source (TM ' + TM + ').</div>');							
                               
                            });
							
						});
						
				githubURL += unicodefile;
				
				// Fetch the content of the Markdown file
			   $.ajax({
					url: githubURL,
					success: function (data) {
						var htmlContent = parseMarkdown(data);
						$('#markdownContent').html(htmlContent);
						//if(htmlContent){ document.getElementById('loader').style.display = "none";}
						}
				});  
			}
		});
	}
			
			function getRootFolder(filePath) {
                var segments = filePath.split('/');
                var index = segments.indexOf('Unicode');

                if (index !== -1 && segments.length > index + 1) {
					return segments[index + 1];
                }

                return null;
            }

            // Parse the Markdown content and format it
            function parseMarkdown(mdContent) {
                var lines = mdContent.split('\n');
                var htmlContent = '<div class="block-heading">';

                for (var i = 0; i < lines.length; i++) {
                    var line = lines[i];

                    if (line.startsWith('##')) {
                        // Level 2 heading, wrap in <h4> tags
                        htmlContent += '<h4>' + line.substring(2).trim() + '</h4>';
                    } else if (line.startsWith('#')) {
                        // Level 1 heading, wrap in <h2> tags
                        htmlContent += '<h2 class="text-info">' + line.substring(1).trim() + '</h2></div><div class="block-content">';
						
									var newTitle = 'STaTbS21D - ' +  line.substring(1).trim();
									document.title = newTitle;
                    } 				
					else {
                        // Normal text line
                        htmlContent += line;
                    }

                }
				
				htmlContent += '</div>';
				
                return htmlContent;
            }
		
			function stripURLs() {
			
				$('.container').each(function() {
					var text = $(this).html();
					var regexA = /\[([\s\S]*?)\]\((.*?)\)/gi;
					var regexB = /((?:https?|ftp):\/\/[^\s]+)/g; // /(https?|ftp):\/\/[^\s]+/g
					var replacedText = text.replace(regexA, function(match, p1, p2) {
					  return '<a href="' + p2 + '">' + p1 + '</a>';
					});
					replacedText = replacedText.replace(regexB, '<a href="$1">$1</a>');
					$(this).html(replacedText);
				  });
			}
			
			function numberHieroLines() {
			  
			  $('hiero').each(function() {
				var lines = $(this).html().split('<br>');
				var numberedText = "";
				var lineNumber = 0;

				for (var i = 0; i < lines.length; i++) {
				  if (lines[i].trim() !== '') {
					lineNumber++;
					numberedText += "<sup>" + lineNumber + "</sup>| " + lines[i].trim();
					if (i !== lines.length - 1) {
					  numberedText += "<br>";
					}
				  }
				}

				$(this).html(numberedText);
			  });
			  
			}

		
			getUnicodeFile();
			
			if(getUnicodeFile()) { stripURLs(); numberHieroLines(); }
			
        });
		
</script>

<footer id="footer" class="page-footer dark"></footer>

<script>
const pag = '#nunicodefile';
$(document).ready(function () {
$('#nav-bar').load('nav.html');
$('#footer').load('footer.html');
});
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/baguettebox.js/1.11.1/baguetteBox.min.js"></script><script src="assets/js/script.min.js"></script>
</body></html>