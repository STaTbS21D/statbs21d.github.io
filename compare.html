<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no"><title  id="page-title">STaTbS21D - Spell Coding</title><meta name="description" content="Synoptic Edition of Book of the Dead Spell Sources from the 21st Dynasty (STaTbS21D) is a Digital Humanities project on Egyptology, provides edited and digitalized Book of the Dead spell sources from the end of the New Kingdom and the beginning of the Third Intermediate Period (particularly the 21st Dynasty) for the Egyptological community and the general public.">

<meta property="og:title" content="STaTbS21D - Synoptic Edition of Book of the Dead Spell Sources from the 21st Dynasty" />
<meta property="og:type" content="website" />
<meta property="og:icon" content="assets/img/statbs21d.svg" />
<meta property="og:image" content="assets/img/site.jpg" />
<meta property="og:image:width" content="1067">
<meta property="og:image:height" content="600">
<meta property="og:description" content="Synoptic Edition of Book of the Dead Spell Sources from the 21st Dynasty (STaTbS21D) is a Digital Humanities project on Egyptology, provides edited and digitalized Book of the Dead spell sources from the end of the New Kingdom and the beginning of the Third Intermediate Period (particularly the 21st Dynasty) for the Egyptological community and the general public." />
<link rel="prefetch" href="nav.html"><link rel="prefetch" href="footer.html">
<link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,400i,700,700i,600,600i&amp;display=swap"><link rel="stylesheet" href="assets/fonts/simple-line-icons.min.css"><link rel="stylesheet" href="assets/fonts/font-awesome.min.css">
<link href="https://db.onlinewebfonts.com/c/0c5e6f133b0b25edfed47aca4ab57676?family=Segoe+UI+Historic" rel="stylesheet"> 
<!--link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Egyptian+Hieroglyphs&display=swap" rel="stylesheet"-->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/baguettebox.js/1.11.1/baguetteBox.min.css">
<link  id="page-css" rel="stylesheet" href="assets/css/styles.min.css">
<script src="assets/js/jquery-3.6.3.js?h=84e399b8f2181ccd73394fdeddff1638"></script>
<script src="assets/js/crypto-js.min.js"></script>
<style>
	#block-content {
		overflow-wrap: break-word !important; 
		word-wrap: break-word !important; 
		white-space: normal !important; 
	}

hiero {
    display: block !important; 
    margin: 0 !important; 
	overflow-wrap: break-word !important;
	font-variant-ligatures: common-ligatures discretionary-ligatures;
}

.hiero {
    display: inline !important;
    white-space: nowrap !important; 
}

@font-face {
  font-family: 'statbs21d';
  src:  url('assets/fonts/statbs21d.eot?enjm2s');
  src:  url('assets/fonts/statbs21d.eot?enjm2s#iefix') format('embedded-opentype'),
    url('assets/fonts/statbs21d.ttf?enjm2s') format('truetype'),
    url('assets/fonts/statbs21d.woff?enjm2s') format('woff'),
    url('assets/fonts/statbs21d.svg?enjm2s#statbs21d') format('svg');
  font-weight: bolder;
  font-style: normal;
  font-display: block;
}

[class^="icon-"], [class*=" icon-"] {
  font-family: 'statbs21d' !important;
  speak: never;
  font-style: normal;
  font-weight: 900;
  font-size: 25px;
  font-variant: normal;
  text-transform: none;
  line-height: 1;

  /* Better Font Rendering =========== */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.icon-Female:before {
  content: "\e909";
}
.icon-Male:before {
  content: "\e90a";
}
.icon-Owner:before {
  content: "\e900";
}
.icon-Family:before {
  content: "\e901";
}
.icon-Source:before {
  content: "\e902";
}
.icon-Script:before {
  content: "\e903";
}
.icon-Vignettes:before {
  content: "\e904";
}
.icon-Sequence:before {
  content: "\e905";
}
.icon-Origin:before {
  content: "\e906";
}
.icon-Dating:before {
  content: "\e907";
}
.icon-Location:before {
  content: "\e908";
}
input[type="radio"] {display: none;}

.switch-container {
    position: relative;
    width: 200px;
    height: 50px;
    background: #3b99e0; /*black;*/
    border-radius: 25px;
    user-select: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    padding: 5px;
    box-sizing: border-box;
  }

  .option {
    flex: 1;
    text-align: center;
    color: black;
    z-index: 2;
    font-weight: 600;
    font-size: 16px;
  }

  .option.left {
    border-radius: 20px 0 0 20px;
  }

  .option.right {
    border-radius: 0 20px 20px 0;
  }

  .slider {
    position: absolute;
    top: 5px;
    bottom: 5px;
    width: 50%;
    background: #fff; /* slightly lighter black for distinction */
    border-radius: 25px;
    transition: left 0.3s ease;
    z-index: 1;
    left: 5px; /* start on left */
  }

  
  label.option {
    flex: 1;
    text-align: center;
    color: black;
    z-index: 2;
    font-weight: 600;
    font-size: 16px;
    border-radius: 20px;
    cursor: pointer;
    user-select: none;
    transition: color 0.3s ease;
  }

  label.left {
    border-radius: 20px 0 0 20px;
  }

  label.right {
    border-radius: 0 20px 20px 0;
  }

  /* Change slider position and label colors when inputs are checked */
  #option1:checked ~ .slider {
    left: 5px;
  }

  #option2:checked ~ .slider {
    left: 48%;
  }

  #option1:checked ~ label[for="option1"] {
    color: black;
  }

  #option1:checked ~ label[for="option2"] {
    color: white;
  }

  #option2:checked ~ label[for="option2"] {
    color: black;
  }

  #option2:checked ~ label[for="option1"] {
    color: white;
}

.switch {
    position: relative;
    width: 60px;
    height: 10px;
    border-radius: 25px;
    user-select: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    padding: 5px;
    box-sizing: border-box;
	
  }
	
	#sldr {
	position: relative; display: flex; flex-direction: row; align-items: center;
	-webkit-justify-content: center;
  justify-content: center;
  -webkit-align-items: center;
  top: 2em;
	}
	
	.floating {
    position: fixed; top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
    top: 1em;
	display: flex; flex-direction: row; align-items: center;
	-webkit-justify-content: center;
  justify-content: center;
  -webkit-align-items: center;
  }
  .stopped {
    position: absolute; top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
	display: flex; flex-direction: row; align-items: center;
	-webkit-justify-content: center;
  justify-content: center;
  -webkit-align-items: center;
  }
  
  .files-list {
    position: relative;
    min-height: 200px;
    padding: 70px 20px 20px 20px;
    background: #f8f9fa;
    border-radius: 8px;
    margin: 20px 0;
    border: 1px solid #e9ecef;
}

.file-item {
    display: flex;
    align-items: flex-start; /* Align items to top for multi-line labels */
    gap: 10px;
    padding: 8px 12px;
    margin: 4px 0;
    border-radius: 6px;
    transition: background-color 0.2s ease;
}

.file-item:hover {
    background-color: #e9ecef;
}

.source-checkbox {
    flex-shrink: 0;
    margin-top: 2px; /* Align with first line of text */
}

.file-item label {
    flex: 1;
    margin: 0;
    cursor: pointer;
    line-height: 1.4;
    word-wrap: break-word;
    overflow-wrap: break-word;
    white-space: normal;
    display: block;
}

@media (max-width: 768px) {
    #submit-sources {
        position: fixed;
        bottom: 20px;
        right: 20px;
        top: auto;
        left: auto;
        border-radius: 50%;
        width: 60px;
        height: 60px;
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0;
    }
    
    #submit-sources::before {
        content: "Compare";
        font-size: 0;
    }
    
    #submit-sources::after {
        content: "⇌"; /*⚡*/
        font-size: 30px;
		color: #3b99e0;
    }
    
	#submit-sources:hover {
		color: #fff;
	}
	
    .files-list {
        padding: 20px 15px 80px 15px; /* Extra padding at bottom for mobile button */
    }
}
</style>
</head>

<body>

<script>
window.onload = function() {
document.getElementById("loader").style.display = "none";
document.getElementById("content").style.display = "block";
};

$(document).ready(function() {
  if(window.location.hash) {
    var target = $(window.location.hash);
    if(target.length) {
      $('html, body').animate({
        scrollTop: target.offset().top
      }, 1000);
    }
  }
});
</script>
<svg aria-hidden="true" style="position: absolute; width: 0; height: 0; overflow: hidden;" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<defs>
<symbol id="icon-oraec" viewBox="0 0 28 32">
<path d="M7.277 7.029c0.951 0.965 7.754 18.223 8.576 20.777-11.908 2.636-12.213-14.278-8.576-20.777zM21.747 10.919c0.795 4.059 0.869 11.242-1.872 14.48-1.149-1.613-8.31-19.547-8.424-21.363 6.175-0.745 9.083 0.683 10.296 6.883zM10.805 0.332c-9.557 1.611-11.539 10.2-10.59 18.933 1.007 9.266 7.404 14.138 16.791 12.379 9.334-1.749 11.173-10.586 10.352-18.964-0.947-9.669-6.971-13.963-16.553-12.348z"></path>
</symbol>
<symbol id="icon-statbs21d" viewBox="0 0 28 32">
<path d="M20.708 30.382c-0.253 0.254 0.073 0.073 0.077 0.077 0.001 0.001-0.023-0.012-0.023-0.022 0-0.026-0.036-0.073-0.055-0.055zM20.142 29.816c0-0.447 0.232-0.018 0.112 0-0.002 0-0.112 0.48-0.112 0zM21.037 28.478c0.211-0.483 0.169-0.646 0-1.1-0.224 0.451-0.224 0.649 0 1.1zM20.708 26.984c-0.328 1.366 0.295 1.377-0.329 1.872-0.082-2.261-0.11-1.701 0.329-1.872zM7.403 28.335c-0.496-0.198-0.655 0.1-0.381-0.832 0.1-0.339 0.358-0.681 0.611-0.88l-0.23 1.712zM20.708 26.418v0zM7.871 24.152v0zM4.496 20.804c-0.227 0.227 0 0 0 0zM4.9 19.67c-0.294 0.294 0.291-0.291 0 0zM20.897 19.243c0.794-0.305 0.159 0.167 0.629-0.184 0.278-0.208-0.082-0.126 0.456-0.555l-0.032 1.98c-0.005 0.544-0.171 1.092-0.437 1.574-0.221-2.015 0.591-1.982-0.615-2.816zM21.086 18.677c0.018-0.018 0.055 0.029 0.055 0.055 0 0.011 0.023 0.023 0.023 0.022-0.004-0.004-0.331 0.177-0.077-0.077zM22.030 18.332c-0.46-0.379-0.213-1.239-0.14-1.904 0.355 0.476 0.308 1.487 0.14 1.904zM11.269 16.6v0zM7.871 24.152c0.288-0.415 0.306-0.9 0.555-1.695 0.527-1.686 0.629-5.025 2.277-5.856-0.356 1.471-1.29 2.995-1.682 4.737l-1.338 5.113c-0.286-0.51 0.101-2.108 0.189-2.298zM10.702 16.6v0zM22.030 16.255c-0.36-0.627-0.134-0.781 0-1.354 0.196 0.315 0.152 1.069 0 1.354zM20.331 15.845c-0.392 0.259-0.015 0.177-0.772 0.205-0.415-0.781 0.046-0.214-0.156-0.788-1.042 0.467 0.254 0.132-0.788 0.599l-0.616-0.549c-0.576 0.797-0.675 0.548-1.822 0.532-0.872-0.012-1.77 0.293-2.141 0.254-0.036-0.541 0.561-0.803 0.13-1.732l-0.735 1.798-0.998 0.004c-0.64 0.162 0.153 0.406-1.164 0.431 0.124-1.448 1.064-1.914 1.297-3.185-1.581 0.296-0.017 0.26-2.302 2.59-0.412-0.866-0.135-1.373-1.191-2.118-1.184-0.834-1.696-0.048-2.769-0.439-0.474-0.737 0.593-0.394 0.18-0.875-0.012-0.014-0.746-0.465-0.831-0.556-0.851-0.918-0.216-1.051-0.215-1.816-0.114 0.416-0.295-0.307-0.751-0.604 1.117 2.252 1.438-0.164 0.751 0.604 0.086 0.802 0.558 1.398 0.755 2.849 0.362 1.201-1.49 5.83-2.085 6.945-0.931 1.745-0.106 3.666-2.934 3.67-1.316-0.023 0.207-0.119-0.972-0.272-0.15 0.379-0.317 0.389-0.087 0.783 1.282 0.213 2.17 0.142 3.466-0.729 0.978-0.657 0.86-0.521 1.080-1.531 0.407-0.957 0.275-0.562 0.596-1.323l1.020-3.237c0.336-1.074 1.058-2.305 1.237-3.559 0.821 0.249-0.134 0.052 0.77 0.396 0.281 0.107 0.207-0.056 0.753 0.29 0.089 0.75-0.439-0.305 0.2 0.703 0.569 0.897-0.396-0.335 0.124 0.863 0.064 0.148 0.432 0.5 0.567 0.679-1.862 2.89-1.347 2.546-1.838 4.971-0.115 0.568-2.073 6.274-2.123 7.189l1.318 0.358c-0.103 0.563-0.14 1.425-0.357 1.891 1.168-0.015 0.905-1.044 0.966-2.071 0.049-0.831 0.191-1.487 0.24-2.301 0.045-0.742 0.511-1.431 0.673-2.245 0.186-0.934 0.355-1.733 0.561-2.649 0.311-1.384 0.567-3.773 2.198-4.044 1.37-0.228 3.688-0.114 4.893-0.793-0.513-0.281-4.348 0.447-5.263 0.466 0.203-1.040 7.342-1.641 8.159-1.080-0.275 0.151-1.435-0.109-2.382 0.395 0.634 0.383 1.948-0.16 3.102 0.042l0.499 1.744c-0.977 0.58-2.268 0.148-2.79 0.768l2.46-0.054c0.178 0.702-0.177 4.152-0.374 4.941-2.697 0.745-9.194 0.049-10.286 0.658 0.585 0.013 0.411 0.095 0.96 0.108l3.754-0.006c1.744-0.079 3.302 0.147 4.332-0.1 0.778-0.187 0.050-0.043 0.653-0.090 0.272-0.021 0.324 0.056 0.627-0.103 0.034 0.42-0.024 0.437-0.030 0.655l-0.084 2.39c-0.097 0.891-0.241 2.518-0.195 3.345 1.010-0.053 0.247 0.141 0.69-0.722 0.089 0.788-0.279 0.697 1.142 0.715 0.080-0.765 0.297-1.443 0.281-2.147-0.051-2.268-0.371-0.573-0.108-2.335-0.657 0.476-0.288 0.596-0.895 0.361l0.427-0.354-0.427-0.212c-0.529-1.148 0.041-4.765 0.237-6.592 0.676 1.226-0.346 1.993 0.189 3.366l0.413-0.934c0.14 0.797-0.107 2.639-0.256 3.421-0.762 0.124 0.407-0.799-0.55-0.14 0.357 0.718 0.129 0.489 0.847 0.847 0.783-0.768 0.188-0.501 0.285-1.174 0.054-0.374 0.156-1.265 0.223-1.915 0.059-0.573 0.089-1.016 0.12-1.781l0.435-3.533c0.3-0.906 0.144-1.805 0.099-3.061-0.453-0.954 0.343-1.376-0.006-2.604 0.052-2.142 0.312-0.283-0.295-1.965-0.22-0.634-0.408-1.78-0.408-2.711-1.318 0.027-0.457 0.821-0.27 2.058 0.147 0.973-0.17 1.111 0.246 2.041-0.249 1.248 0.034-0.12-0.301 2.764-0.131 1.133-0.127 2.523-0.44 3.072l-0.944-1.731zM16.555 6.595c0.19-0.19 0.578 0.246 0.209 0.097-0.004-0.002-0.464 0.157-0.209-0.097zM12.811 0.586c0.577 0.006 0.761 0.308 1.141 0.681 0.454 0.446 2.537 2.977 2.036 3.85-1.005-0.77-0.642-1.373-1.529-2.279-0.955-0.976-1.013-1.122-1.648-2.252zM17.688 0.553c0.19-0.19 0.578 0.246 0.209 0.097-0.004-0.002-0.464 0.157-0.209-0.097zM10.136 4.518c0.656 0.584 0.537 0.202 1.273 0.55-0.214-1.487-3.283-2.658-3.037-3.636 0.628-0.043 0.928 0.916 1.953 1.009-0.311-1.15-0.604-0.764-1.293-1.26 1.468-1.067 2.96 0.938 4.074 2.444 0.952 1.287 0.47 1.189 1.204 1.471 0.321-0.604-0.784-1.776-1.289-2.33-0.775-0.85-1.691-1.512-1.727-2.188 0.966 0.029 2.565 2.182 3.088 3.093 0.206 0.359 0.403 0.93 0.696 1.413l-0.41 0.378 1.149-0.005c0.526 0.927 0.265 1.781-0.431 2.642 0.852 0.453-0.036-0.228 0.799 0.171-0.194 0.801-0.534 3.812-0.196 4.397 0.58-1.005 0.212-4.631 0.812-5.478 0.266 0.363 0.249 2.069 0.178 2.821-0.043 0.454-0.133 0.138-0.22 0.928-0.094 0.856-0.496 4.053-0.203 4.561 0.514-0.821 0.453-2.304 0.68-3.882 0.105-0.731 0.070-1.544 0.134-2.302l0.087-0.748c0.299-1.566-0.271-2.592-0.708-3.675-0.532-1.318-1.418-3.013-2.426-4.026 2.074-1.068 2.589 1.361 3.371 4.002 0.224 0.757-0.195 1.106 0.75 1.726-0.031-1.478-0.516-1.967-0.785-3.179-0.234-1.053-0.725-1.856-0.885-2.661 1.054 0.061 1.242 0.841 1.747 2.365 0.278 0.838 0.468 3.142 0.686 3.513 1.151-1.014-1.016-5.145-1.090-5.711 0.729 0.609 1.009 0.865 1.451 1.718 0.532 1.027 0.148 1.946 0.932 2.237-0.175-0.916-0.226-1.772-0.742-2.574 0.777 0.104 1.038 1.592 1.302 2.565 0.008 0.029 0.024 0.081 0.031 0.11 0.225 0.965 0.119 3.381 0.848 3.681 0.514-0.94-0.843-5.996-1.532-7.045-0.327-0.499-2.070-1.422-3.414-1.426-0.721-0.002-0.395-0.279-1.889-0.152l-2.624 0.031c-0.858-0.019-2.438 0.45-3.437 0.716-0.979 0.261-1.802 1.076-2.114 2.115 1.183 0.423-0.546-1.952 3.349 1.104 0.088 0.806 0.007 0.292-0.14 0.518zM12.402 6.028v0zM12.402 6.028c-0.365-0.554-0.283-0.189-0.254-0.631 0.493-0.034 0.455 0.249 0.96 0.615-0.15-1.022-2.114-2.548-2.784-3.571 0.639 0.071 1.565 1.121 2.064 1.711l1.523 2.097c0.478-0.61 0.121-0.547 0.755-0.788-0.043 2.020-0.152 0.316 0.156 1.856-0.744-0.147-0.184-0.128-0.578-0.278l-2.495-0.365c-2.116-0.658-2.153-1.188-5.218-0.663-0.516 0.932-0.316 2.143-1.683 2.47 0.238-0.657 0.007-0.066 0.353-0.591 0.852-1.292 0.413-0.913 0.844-2.337 0.378-1.25 0.2-3.713 2.141-2.308 0.558 0.404 1.068 0.604 1.382 1.083l-1.149 0.205c-0.224-0.529-0.379-1.177-1.257-1.289-0.526 0.724 0.195 0.343-0.599 2.357 0.972 0.089 0.561-0.192 1.678-0.361 1.513-0.23 0.345 0.077 1.52 0.181 0.975 0.086 0.361-0.449 1.357 0.38 0.856 0.712 0.147 0.33 1.281 0.227zM7.115 7.539c-0.041 0.113 0.251 0.457 0.451 0.028 0.216-0.462-0.143-0.044-0.174-0.047-0.016-0.002-0.255-0.040-0.277 0.019zM6.216 8.29c-0.035-1.964 2.886-1.811 3.768-1.322-0.352 0.147-0.505-0.015-1.166 0.049 0.541 0.71 0.67 1.263 1.51-0.082 1.43 0.911 1.434-0.378 3.177 0.542-1.69 1.639-1.4-0.3-3.149 0.274-0.52 0.171-1.316 0.486-1.862 0.598-0.512 0.106-1.112-0.104-1.609-0.574-0.679 0.177 0.029-0.070-0.669 0.513zM8.831 26.558c0.234-0.116 2.174-0.393 2.496-0.375 1.398 0.077 7.269-0.5 7.887-0.159-0.219 0.509 0.004 0.279-0.58 0.398l-2.2 0.037c-0.982-0.021-0.749 0.102-1.262 0.169l-3.475-0.144c-0.782 0.075-2.329 0.382-2.866 0.074zM20.331 15.845c-0.508-0.198-0.219 0.215-0.378-0.378 0-0.574-0.057-0.926 0.103-1.413 0.786-2.399 0.167-0.186 0.424-2.804 0.030-0.303 0.128-1.064 0.127-1.255-0.004-1.433-0.621-2.774 0.29-3.024 0.001 0.855 0.189 1.463 0.161 2.266l-0.101 2.038c-0.073 1.866-0.626 2.767-0.626 4.57zM10.735 18.742c0.634-0.47 1.789-0.404 2.613-0.444 1.853-0.089 4.722-0.628 4.746-0.629 1.733-0.073 1.502-0.32 2.049-0.125-0.613 1.216-0.369 0.22-2.087 0.542-0.795 0.149-6.607 0.882-7.321 0.656zM11.080 21.32c0.177-0.418 0.263-0.49 0.969-0.528 0.698-0.038 0.37 0.116 1.114 0.144l2.64-0.179c0.713-0.030 1.556-0.256 2.178-0.326 0.932-0.105 1.461-0.456 1.972 0.323l-2.379 0.090c-0.668 0.058-1.492 0.225-2.023 0.248l-4.471 0.229zM14.667 10.37c-0.505 0.36-0.902 1.865-0.976 2.611-0.691-0.114-0.429-0.245-1.052 0.205-0.009-0.357 1.738-4.131 2.562-4.294 0.053 0.68 0.152 0.804-0.157 1.289l-0.352-0.363-0.026 0.552zM19.436 13.72c-0.504-0.693-0.095-0.931-0.047-1.837l-0.058-3.691c-0.108-1.153 0.1-0.928 0.402-0.999l0.082 6.079c-0.23 0.8 0.122 0.287-0.379 0.448zM12.024 23.176c0.626 0.735 1.069 0.222 3.97 0.227 1.046 0.002 3.032-0.598 3.738-0.129-0.741 0.322-3.48 0.44-4.162 0.358-0.815-0.099-2.032 0.176-3.048 0.247-1.187 0.083-0.827 0.264-1.269-0.276l0.209-0.034c0.635-0.115 0.416-0.076 0.562-0.392zM12.181 27.55c0.587-0.337 1.339-0.167 2.119-0.185 1.725-0.040 3.681-0.572 5.26 0.045-0.828 0.41-1.325 0.048-2.43 0.123l-3.223 0.013c-1.426 0.008-1.189 0.28-1.725 0.004zM8.437 30.76c2.075 0 4.164-0.025 6.237-0.007 1.273 0.011 1.557 0.41 2.835 0.018 1.389-0.427 1.501-0.159 1.873 0.365l-10.946-0.375zM18.066 14.934c-0.481-0.839-0.059-0.51 0.066-1.052l0.039-1.126c0.1-0.752 0.131-2.002 0.462-2.606 0.413 0.719 0.076 1.766-0.009 2.666-0.027 0.285-0.14 1.046-0.208 1.317l-0.349 0.801zM9.947 22.264c0.56-0.389 4.373-0.239 5.27-0.14-0.457 0.613-1.857 0.126-2.628 0.127l-1.409 0.086c-0.82-0.027-0.629 0.195-1.233-0.073zM14.667 10.371l0.377-0.189c0.002 0.868-0.2 1.665-0.287 2.457-0.165 1.504-0.106 1.256-0.484 1.523-0.331-0.616 0.112-1.351 0.21-1.709l0.184-2.083zM15.832 22.011c0.209-0.097 1.535-0.263 1.997-0.36 0.527-0.111 1.314-0.324 1.902 0.112-0.336 0.157-3.473 0.565-3.9 0.248zM16.037 30.145c-0.286-0.393-0.275-0.701-0.122-1.145 0.24-0.695 0.015-0.528 0.812-0.458-0.638 1.329 0.548 1.609-0.69 1.602zM18.632 10.025c-0.386-0.677-0.268-0.887-0.268-1.431 0.001-0.503-0.187-0.982 0.079-1.466 0.394 0.684 0.617 2.151 0.189 2.897zM9.743 30.021c-0.062-0.172-0.124-0.678-0.096-0.922 0.172-1.531 1.918 0.654 0.096 0.922zM15.422 15.5c-0.407-0.71 0.037-2.039 0.426-2.659 0.242 0.487-0.020 2.144-0.426 2.659zM18.492 29.988c-0.334-0.854-0.508-1.442 0.469-1.634 0.456 0.637 0.189 0.134-0.028 0.968-0.18 0.69 0.485 0.177-0.441 0.667zM10.924 29.692c0.329-0.711 0.064-0.75 0.739-1.025 0.404 0.839-0.515 0.106 0.329 1.025-1.479 0.77 0.722-0.178-0.612 0.667l-0.456-0.667zM12.056 19.745c0.277-0.128 3.042-0.319 3.539-0.264-0.6 0.294-2.906 0.733-3.539 0.264zM14.856 30.226c-0.543-0.871-0.237-1.576 0.361-1.683-0.17 0.434 0.091 0.941 0.161 1.407l-0.523 0.276zM13.281 30.161c-0.904-0.63-0.381-1.648-0.189-1.823 0.528 0.712 0.126 0.561 0.238 1.029 0.061 0.252 0.538 0.003-0.050 0.795zM12.386 15.861c-0.149-0.462 0.529-1.99 0.82-2.454 0.168 0.407 0.043 0.646-0.156 1.183-0.403 1.092-0.059 0.999-0.664 1.271zM21.086 25.128c-0.741-0.615-0.357-1.118 0.049-1.715 0.324 0.655 0.070 0.398 0.047 0.981-0.029 0.719 0.214 0.136-0.096 0.734zM9.209 27.599c0.547-0.060 0.952-0.035 1.504-0.045 0.712-0.012 0.788-0.146 1.156-0.004-0.406 0.233-1.75 0.342-2.183 0.304-0.344-0.031-0.108 0.21-0.476-0.255zM17.147 29.971l0.336-1.493c0.449 0.193 0.229-0.043 0.326 0.326l-0.026 0.486c-0.091 0.616-0.142 0.583-0.636 0.68zM15.8 19.432c0.909 0 0.699-0.248 1.683-0.14-0.651 0.485-0.803 0.329-1.683 0.329v-0.189zM6.862 11.757c-0.046-0.303-0.071-0.079 0.017-0.327 0.098-0.275 0.118-0.164 0.268-0.338l0.502 0.476c-0.51 0.371-0.312 0.31-0.788 0.189zM4.711 9.836c-0.589-0.494-0.205-1.373 0.462-1.458l-0.462 1.458zM20.709 6.249c-0.443-0.561-0.478-0.466-0.189-1.009 0.44 0.557 0.488 0.475 0.189 1.009zM13.723 8.671c0.062-0.714 0.086-0.987 0.728-1.091l-0.728 1.091zM21.782 7.788l-0.318-0.816c0.662 0.060 0.646 0.268 0.318 0.816zM10.136 23.774c0.457-0.291 0.227-0.218 0.928-0.14-0.478 0.356-0.366 0.39-0.928 0.14zM10.924 19.826c0.095-0.073-0.065-0.447 0.707-0.065-0.528 0.301 0.101 0.223-0.707 0.065zM19.010 14.335c0.455-0.281-0.034-0.374 0.599 0-0.503 0.297-0.119 0.316-0.599 0zM9.947 22.264c-0.148 0.457 0.131 0.303-0.254 0.254-0.044-0.341-0.289-0.13 0.254-0.254zM10.325 21.131c-0.256-0.256 0.213-0.099 0.218-0.101 0.379-0.142-0.035 0.284-0.218 0.101zM13.723 8.86l-0.377-0.101 0.377-0.088v0.189zM13.723 8.86l0.188 0.064-0.139 0.109-0.049-0.173zM18.443 6.595l0.188 0.064-0.139 0.109-0.049-0.173zM18.254 22.831c-0.254-0.254 0.073-0.073 0.077-0.077 0.001-0.001-0.023 0.033-0.023 0.023 0-0.026-0.036 0.073-0.055 0.055zM2.018 23.397c-0.256-0.256 0.058 0.058 0 0zM14.479 24.152c-0.254-0.254 0.073-0.073 0.077-0.077 0.001-0.001-0.022 0.033-0.022 0.022 0-0.026-0.036 0.073-0.055 0.055zM7.304 3.951c-0.254-0.254 0.072-0.073 0.077-0.077 0.001-0.001-0.022 0.033-0.022 0.023-0-0.026-0.037 0.073-0.055 0.055zM10.136 4.518v0z"></path>
</symbol>
</defs>
</svg>

<div id="loader" style="position: fixed;top: 50%;left: 0;width: 100%;height: 100%;background-color: #fff;z-index: 9999;"><img src="assets/img/loading.gif" alt="Loading..." style="display: block;margin: auto;">
<p style="text-align: center;">Loading...</p></div>

<div id="content" style="display:none;">

<nav id="nav-bar" class="navbar navbar-light navbar-expand-lg sticky-top bg-white clean-navbar" style="position: relative;overflow: visible;display: inline;"></nav>

<main class="page faq-page">
<div class="clean-block clean-faq dark" style="margin-bottom:-8em"><div class="block-heading"><h2 class="text-info">Spell Compare</h2></div></div>
<section class="clean-block clean-faq dark">
<div id="markdownContent" class="container">
  <div id="loader" align="center"><br><br><div class="block-content"><img src="assets/img/loading.gif" /></div></div>
</div>
<div id="loadcompare" class="container"></div>
</section>
<footer id="footer" class="page-footer dark"></footer>
<script>
const pag = '#ncompare';
$(document).ready(function () {
$('#nav-bar').load('nav.html');
$('#footer').load('footer.html');
});


$(document).ready(function() {
    var owner = 'STaTBS21D';
    var repo = 'Book_of_the_Dead_Sources';
    var token = 'U2FsdGVkX18RuJN5XTj898CCXpHsKmJu1CbYQQEHv/Xp0dK5lzFaVYJD8S+7c8+tPZraAcAIlnCYNsXwDh4e8zncRnWT3883LudltXWh6SKlZ+Jv3aB4t5gT/TLY3rj2+h3XNKUDB4Y+x2WACRYTiQ=='; 
    var password = 'senerpaitui';
    var decryptedBytes = CryptoJS.AES.decrypt(token, password);
    token = decryptedBytes.toString(CryptoJS.enc.Utf8);

    // Global variable to track selected files - defined once at top level
    var selectedFiles = [];
    var currentSpellNumber = null;

    // Get spell number from URL parameter
    var urlParams = new URLSearchParams(window.location.search);
    var spellNumber = urlParams.get('sp');
    currentSpellNumber = spellNumber;

    if (spellNumber) {
        getSpellFiles(spellNumber);
    }

    function getSpellFiles(spellNumber) {
    var url = 'https://api.github.com/repos/' + owner + '/' + repo + '/git/trees/main?recursive=1';

    var headers = {
        'Authorization': 'Bearer ' + token,
        'X-GitHub-Api-Version': '2022-11-28'
    };

    $.ajax({
        url: url,
        headers: headers,
        success: function(response) {
            var spellFiles = [];
            var spellFolder = 'Spell ' + spellNumber;
            
            console.log('Looking for files in folder:', spellFolder);
            
            $.each(response.tree, function(index, item) {
                if (item.type === 'blob') {
                    // Check if path matches: "Spell X/Unicode/" pattern and is a .md file
                    var expectedPathStart = spellFolder + '/Unicode/';
                    if (item.path.startsWith(expectedPathStart) && item.path.endsWith('.md')) {
                        spellFiles.push(item.path);
                    }
                }
            });

            console.log('Found ' + spellFiles.length + ' files for ' + spellFolder);
            console.log('Files:', spellFiles);
            
            displaySpellFiles(spellFiles, spellNumber);
        },
        error: function(xhr, status, error) {
            console.error('Error fetching repository data:', error);
            $('#markdownContent').html('<br><br><div align="center"><p class="text-bg-danger small" style="width:60%;border-radius: 18px;text-align: center">Error fetching files from GitHub repository. The spell is not available.</p></div>');
        }
    });
}

    function displaySpellFiles(filePaths, spellNumber) {
        var $sourcesDiv = $('#markdownContent');
        $sourcesDiv.empty();

        if (filePaths.length === 0) {
            $sourcesDiv.html('<div align="center"><p class="text-bg-danger small" style="width:60%;border-radius: 18px;text-align: center">No spell sources found.</p></div>');
            return;
        }

        var filesList = $('<br><div class="files-list block-content"></div>');
        // Reset selectedFiles when displaying new files
        selectedFiles = [];

        filePaths.forEach(function(filePath) {
            var fileName = getFileNameWithoutExtension(filePath);
            
            // Process file name formatting
            var fileSeparator = fileName.indexOf(' - ');
            var displayName = fileSeparator !== -1 ? fileName.substr(fileSeparator + 3) : fileName;
            
            // Remove dating info and file extension
            var dating = "";
            var dateclass = "";
            
            if (displayName.endsWith('[Ramesside]')) {
                displayName = displayName.replace('[Ramesside]', '').trim();
                dating = "Ramesside";
                dateclass = "dating-ram";
            } else if (displayName.endsWith('[Ramesside - 21D]')) {
                displayName = displayName.replace('[Ramesside - 21D]', '').trim();
                dating = "Ramesside / 21<sup>st</sup> Dyn.";
                dateclass = "dating-ram21d";
            } else if (displayName.includes('[21')) {
                // Handle other 21st dynasty variations
                var dateMatch = displayName.match(/\[(.*?)\]/);
                if (dateMatch) {
                    dating = dateMatch[1].replace('21st', '21<sup>st</sup>');
                    dateclass = "dating-21d";
                    displayName = displayName.replace(dateMatch[0], '').trim();
                }
            } else {
                dating = "21<sup>st</sup> Dynasty";
                dateclass = "dating-21d";
            }

            // Create checkbox container
            var fileItem = $('<div class="file-item"></div>');
            
            // Create checkbox
            var checkbox = $('<input type="checkbox" class="source-checkbox">')
                .attr('data-filename', fileName)
                .attr('id', 'file-' + fileName.replace(/[^a-zA-Z0-9]/g, '-'));
            
            // Create label
            var label = $('<label></label>')
                .attr('for', 'file-' + fileName.replace(/[^a-zA-Z0-9]/g, '-'))
                .html(displayName);
            
            // Create dating span
            if (dating) {
                var datingSpan = $('<span class="' + dateclass + '"></span>').html(' (' + dating + ')');
                label.append('&nbsp;');
                label.prepend('&nbsp;');
                label.append(datingSpan);
            }
            
            fileItem.append(checkbox).append(label);
            filesList.append(fileItem);
        });

        $sourcesDiv.append(filesList);
        
        // Add submit button - ALWAYS VISIBLE AND ENABLED
        //var submitButton = $('<button id="submit-sources" type="button" class="btn btn-outline-primary btn-lg">Compare Sources</button>');
        //filesList.append(submitButton);
        
        // Apply CSS for positioning
        applyButtonStyles();
        
        // Use event delegation for dynamically created checkboxes
        $(document).off('change', '.source-checkbox').on('change', '.source-checkbox', function() {
            handleCheckboxChange();
        });
        
        // Handle form submission with proper binding - use direct click handler
        // Remove any existing handlers and bind a new one
        $('#submit-sources').off('click').remove();
        var newSubmitButton = $('<button id="submit-sources" type="button" class="btn btn-outline-primary btn-lg">Compare Sources</button>');
        filesList.append(newSubmitButton);
        
        newSubmitButton.on('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            console.log('Submit button CLICKED! selectedFiles:', selectedFiles);
            
            if (selectedFiles.length === 2) {
                console.log('Calling submitSources with:', currentSpellNumber, selectedFiles);
                submitSources(currentSpellNumber, selectedFiles);
            } else {
                alert('Please select exactly 2 sources before comparing. Currently selected: ' + selectedFiles.length);
            }
            return false;
        });
        
        console.log('Submit button event handler bound');
    }

    function handleCheckboxChange() {
        var checkedBoxes = $('.source-checkbox:checked');
        console.log('Checkboxes changed. Checked count:', checkedBoxes.length);
        
        // Remove previous master/copy classes
        $('.source-checkbox').removeClass('master copy');
        
        if (checkedBoxes.length === 0) {
            selectedFiles = [];
        } else if (checkedBoxes.length === 1) {
            selectedFiles = [$(checkedBoxes[0]).attr('data-filename')];
            $(checkedBoxes[0]).addClass('master');
        } else if (checkedBoxes.length === 2) {
            selectedFiles = [
                $(checkedBoxes[0]).attr('data-filename'),
                $(checkedBoxes[1]).attr('data-filename')
            ];
            $(checkedBoxes[0]).addClass('master');
            $(checkedBoxes[1]).addClass('copy');
        } else {
            // If more than 2 are checked, uncheck the current one
            $('.source-checkbox:checked').last().prop('checked', false);
            alert('Please select only two sources: one as master and one as copy.');
            return;
        }
        
        console.log('Selected files updated:', selectedFiles);
    }

    function applyButtonStyles() {
        // Add CSS styles dynamically
        if (!$('#submit-button-styles').length) {
            $('head').append(`
                <style id="submit-button-styles">
                    .files-list {
                        position: relative;
                        min-height: 200px;
                        padding: 70px 20px 20px 20px;
                        background: #f8f9fa;
                        border-radius: 8px;
                        margin: 20px 0;
                        border: 1px solid #e9ecef;
                    }
                    
                    #submit-sources {
                        position: absolute; /*sticky;*/
                        top: 15px;
                        right: 15px; /*
                        background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
                        color: white;
                        border: none;
                        padding: 12px 24px;
                        border-radius: 6px;
                        cursor: pointer;
                        font-size: 14px;
                        font-weight: 500;*/
                        box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
                        z-index: 100; 
						transition: all 0.3s ease;
						float: right;
						margin-left: auto;
						transition: all 0.3s ease;
						/* Ensure it stays within container */
						max-width: calc(100% - 30px);
                    }
                    
                    #submit-sources:hover {
                        /*background: linear-gradient(135deg, #45a049 0%, #3d8b40 100%);*/
                        transform: translateY(-2px);
                        box-shadow: 0 6px 16px rgba(76, 175, 80, 0.4);
                    }
                    
                    .source-checkbox.master:checked {
                        accent-color: #4CAF50;
                    }
                    
                    .source-checkbox.copy:checked {
                        accent-color: #2196F3;
                    }
                </style>
            `);
        }
    }

    function submitSources(spellNumber, sources) {
        console.log('=== submitSources FUNCTION CALLED ===');
        console.log('spellNumber:', spellNumber);
        console.log('sources:', sources);
        
        if (!spellNumber || !sources || sources.length !== 2) {
            console.error('Invalid parameters for submitSources:', spellNumber, sources);
            alert('Invalid selection. Please select exactly 2 files.');
            return;
        }
        
        var postData = {
            sp: spellNumber,
            sources: sources
        };
        
        console.log('Sending POST data:', postData);
        
        var $loadCompareDiv = $('#loadcompare');
        console.log('loadcompare div found:', $loadCompareDiv.length);
        
        // Show loading indicator
        $loadCompareDiv.html('<div class="loading" style="text-align: center; padding: 50px;"><img src="assets/img/loading.gif" alt="Loading..." style="display: block; margin: auto;"><p>Loading comparison...</p></div>');
        
        console.log('Making AJAX call to compareds17.php');
        
        // Test with a simple POST first
        $.ajax({
            url: 'https://mdc2unicode.x10.bz/spellcmp.php',
            type: 'POST', 
            //contentType: 'application/json',
            data: postData,
            dataType: 'html',
            timeout: 30000, // 30 second timeout
            success: function(response, status, xhr) {
                console.log('=== AJAX SUCCESS ===');
                console.log('Status:', status);
                console.log('Response length:', response.length);
                console.log('Response first 500 chars:', response.substring(0, 500));
                
                // Insert the HTML response
                $loadCompareDiv.html(response);
                console.log('Content loaded into loadcompare div');
                
                // Initialize functionality in the loaded content
                setTimeout(function() {
                    initializeAllFunctionality();
                }, 100);
                
                // Hide the file selection and show reset button
                hideMarkdownContentAndShowReset();
            },
            error: function(xhr, status, error) {
                console.error('=== AJAX ERROR ===');
                console.error('Status:', status);
                console.error('Error:', error);
                console.error('XHR status:', xhr.status);
                console.error('Response text:', xhr.responseText);
                
                $loadCompareDiv.html(
                    '<div class="error" style="background: #ffeaea; border: 1px solid #ff6b6b; color: #d63031; padding: 20px; border-radius: 5px; margin: 20px 0;">' +
                    '<h4>Error Loading Comparison</h4>' +
                    '<p>Status: ' + xhr.status + '</p>' +
                    '<p>Error: ' + error + '</p>' +
                    '<p>Please try again.</p>' +
                    '</div>'
                );
            },
            complete: function(xhr, status) {
                console.log('AJAX request complete. Status:', status);
            }
        });
        
        function hideMarkdownContentAndShowReset() {
            console.log('Hiding file selection and showing reset button');
            // Hide the files list and submit button
            $('.files-list').hide();
            $('#submit-sources').hide();
            
            // Create and show reset button
            var resetButton = $('<div align="center"><button id="resetComparison" class="btn btn-outline-primary btn-md"><i class="fa fa-refresh"></i> Start New Comparison</button></div><br>');
            $('#markdownContent').after(resetButton);
            
            // Handle reset button click
            $('#resetComparison').off('click').on('click', function() {
                console.log('Reset button clicked');
                resetToInitialState();
            });
        }
        
        function resetToInitialState() {
            console.log('Resetting to initial state');
            // 1. Show the file selection again
            $('.files-list').show();
            $('#submit-sources').show();
            
            // 2. Remove the reset button
            $('#resetComparison').remove();
            
            // 3. Clear the comparison content
            $('#loadcompare').empty();
            
            // 4. Reset all checkboxes
            $('.source-checkbox').prop('checked', false).removeClass('master copy');
            
            // 5. Reset the selected files array
            selectedFiles = [];
            
            console.log('Selection reset - ready for new selection');
        }
		
		}
        
        function initializeAllFunctionality() {
    console.log('Initializing functionality in loaded content');
    
    // Reinitialize Bootstrap Tooltips if Bootstrap is available
    if (typeof bootstrap !== 'undefined' && bootstrap.Tooltip) {
        var tooltipElements = document.querySelectorAll('[data-bs-toggle="tooltip"]');
        console.log('Found tooltip elements:', tooltipElements.length);
        
        tooltipElements.forEach(function(element) {
            try {
                var existing = bootstrap.Tooltip.getInstance(element);
                if (existing) {
                    existing.dispose();
                }
                new bootstrap.Tooltip(element, {
                    boundary: document.body,
                    container: document.body
                });
            } catch (e) {
                console.error('Error initializing tooltip:', e);
            }
        });
    }
    
    // Try to initialize the target page's functionality
    initializeTargetContent();
}

function initializeTargetContent() {
    console.log('Initializing target content functionality');
    
    // Get the iframe or div containing the target content
    var targetContainer = document.getElementById('your-target-container-id'); // Replace with actual ID
    if (!targetContainer) {
        console.log('Target container not found');
        return;
    }
    
    // If it's an iframe, wait for it to load and then call its initialization
    if (targetContainer.contentWindow) {
        targetContainer.addEventListener('load', function() {
            try {
                if (targetContainer.contentWindow.initializeTargetPage) {
                    targetContainer.contentWindow.initializeTargetPage();
                }
            } catch (e) {
                console.error('Error calling target page initialization:', e);
            }
        });
        
        // If already loaded, call immediately
        if (targetContainer.contentDocument && targetContainer.contentDocument.readyState === 'complete') {
            try {
                if (targetContainer.contentWindow.initializeTargetPage) {
                    targetContainer.contentWindow.initializeTargetPage();
                }
            } catch (e) {
                console.error('Error calling target page initialization:', e);
            }
        }
    } else {
        // If it's a div with loaded content, look for script tags and execute them
        var scripts = targetContainer.querySelectorAll('script');
        scripts.forEach(function(script) {
            if (script.src) {
                // External script, let it load naturally
                return;
            }
            try {
                // Execute inline scripts
                eval(script.innerHTML);
            } catch (e) {
                console.error('Error executing inline script:', e);
            }
        });
        
        // Try to call initialization if available
        setTimeout(function() {
            if (window.initializeTargetPage) {
                window.initializeTargetPage();
            }
        }, 100);
    }
}

// Alternative approach: directly initialize tooltips in the target content
function initializeTooltipsInTarget() {
    var targetContainer = document.getElementById('your-target-container-id'); // Replace with actual ID
    if (!targetContainer) return;
    
    var targetDoc = targetContainer.contentDocument || targetContainer.ownerDocument || document;
    var tooltipElements = targetDoc.querySelectorAll('[data-bs-toggle="tooltip"]');
    
    console.log('Found tooltips in target:', tooltipElements.length);
    
    tooltipElements.forEach(function(element) {
        try {
            // Use the main window's bootstrap
            var existing = bootstrap.Tooltip.getInstance(element);
            if (existing) {
                existing.dispose();
            }
            new bootstrap.Tooltip(element, {
                boundary: document.body,
                container: document.body
            });
        } catch (e) {
            console.error('Error initializing tooltip in target:', e);
        }
    });
}

// Call this after the target content is loaded
function setupHighlightingFunctionality() {
    console.log('Setting up highlighting functionality');
    
    // Your existing highlighting code...
    window.setupHighlighting = function(panelFrom, panelTo) {
        // ... your existing highlighting implementation
    };
    
    // Initialize highlighting
    setTimeout(function() {
        if (document.querySelector('#panelA') && document.querySelector('#panelB')) {
            window.setupHighlighting('#panelA', '#panelB');
            window.setupHighlighting('#panelB', '#panelA');
        }
    }, 200);
}

    function getFileNameWithoutExtension(filePath) {
        var fileName = filePath.split('/').pop();
        return fileName.substring(0, fileName.lastIndexOf('.'));
    }
	
	
});
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/baguettebox.js/1.11.1/baguetteBox.min.js"></script><script src="assets/bootstrap/js/bootstrap-dropdown.js"></script><script src="assets/js/script.min.js"></script>
</body></html>